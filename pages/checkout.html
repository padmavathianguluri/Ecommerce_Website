<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Checkout - MyShop</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="bg-light">
    <div class="container py-5">
      <h2 class="mb-4">Checkout</h2>

      <!-- ✅ Cart Summary -->
      <div class="mb-5">
        <h5>Your Cart:</h5>
        <div id="cartSummary"></div>
      </div>

      <!-- ✅ Checkout Form -->
      <form onsubmit="submitOrder(event)">
        <div class="mb-3">
          <label for="name" class="form-label">Full Name</label>
          <input type="text" class="form-control" id="name" required />
        </div>
        <div class="mb-3">
          <label for="address" class="form-label">Shipping Address</label>
          <textarea
            class="form-control"
            id="address"
            rows="3"
            required
          ></textarea>
        </div>
        <div class="mb-3">
          <label for="phone" class="form-label">Mobile Number</label>
          <input type="tel" class="form-control" id="phone" required />
        </div>
        <button type="submit" class="btn btn-primary">Confirm Order</button>
      </form>
    </div>

    <script>
      function displayCartSummary() {
        const cart = JSON.parse(localStorage.getItem("cart")) || [];
        const container = document.getElementById("cartSummary");

        if (cart.length === 0) {
          container.innerHTML = "<p class='text-muted'>Your cart is empty.</p>";
          return;
        }

        let html = `<table class="table table-bordered">
        <thead><tr>
          <th>Product</th><th>Qty</th><th>Price</th><th>Total</th>
        </tr></thead><tbody>`;

        let total = 0;
        cart.forEach((item) => {
          const subtotal = item.quantity * item.price;
          total += subtotal;
          html += `<tr>
          <td>${item.title}</td>
          <td>${item.quantity}</td>
          <td>$${item.price.toFixed(2)}</td>
          <td>$${subtotal.toFixed(2)}</td>
        </tr>`;
        });

        html += `</tbody></table>
        <h5 class="text-end">Grand Total: $${total.toFixed(2)}</h5>`;

        container.innerHTML = html;
      }

      function submitOrder(event) {
        event.preventDefault();
        localStorage.removeItem("cart");
        alert("Order confirmed!");
        window.location.href = "confirmation.html";
      }

      // Show summary on load
      displayCartSummary();
    </script>
  </body>
</html>
